(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{432:function(a,s,t){a.exports=t.p+"assets/img/Docker-Command-Diagram.35cc1893.png"},620:function(a,s,t){"use strict";t.r(s);var e=t(2),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"常用容器命令-方便查阅复制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用容器命令-方便查阅复制"}},[a._v("#")]),a._v(" 常用容器命令（方便查阅复制）")]),a._v(" "),s("h3",{attrs:{id:"停止所有docker实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#停止所有docker实例"}},[a._v("#")]),a._v(" 停止所有docker实例")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" stop "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-aq")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"删除所有docker-实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除所有docker-实例"}},[a._v("#")]),a._v(" 删除所有docker 实例")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-aq")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"新建启动容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#新建启动容器"}},[a._v("#")]),a._v(" 新建启动容器")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("OPTIONS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" IMAGE "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("COMMAND"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("ARG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("常用的参数：")]),a._v(" "),s("ul",[s("li",[a._v("--name：为容器指定一个名称")]),a._v(" "),s("li",[a._v("-d：后台运行容器并返回容器ID，也即启动守护式容器")]),a._v(" "),s("li",[a._v("-i：以交互模式（interactive）运行容器，通常与-t同时使用")]),a._v(" "),s("li",[a._v("-t：为容器重新分配一个伪输入终端（tty），通常与-i同时使用。也即启动交互式容器（前台有伪终端，等待交互）")]),a._v(" "),s("li",[a._v("-e：为容器添加环境变量")]),a._v(" "),s("li",[a._v("-P：随机端口映射。将容器内暴露的所有端口映射到宿主机随机端口")]),a._v(" "),s("li",[a._v("-p：指定端口映射")])]),a._v(" "),s("p",[a._v("-p指定端口映射的几种不同形式：")]),a._v(" "),s("ul",[s("li",[a._v("-p hostPort:containerPort：端口映射，例如-p 8080:80")]),a._v(" "),s("li",[a._v("-p ip:hostPort:containerPort：配置监听地址，例如 -p 10.0.0.1:8080:80")]),a._v(" "),s("li",[a._v("-p ip::containerPort：随机分配端口，例如 -p 10.0.0.1::80")]),a._v(" "),s("li",[a._v("-p hostPort1:containerPort1 -p hostPort2:containerPort2：指定多个端口映射，例如-p 8080:80 -p 8888:3306")])]),a._v(" "),s("h3",{attrs:{id:"启动交互式容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动交互式容器"}},[a._v("#")]),a._v(" 启动交互式容器")]),a._v(" "),s("p",[a._v("以交互方式启动ubuntu镜像")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -i 交互模式")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -t 分配一个伪输入终端tty")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ubuntu 镜像名称")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# /bin/bash（或者bash） shell交互的接口")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" ubuntu /bin/bash\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("p",[a._v("退出交互模式：")]),a._v(" "),s("blockquote",[s("p",[a._v("方式1：")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在交互shell中exit即可退回宿主机")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("blockquote",[s("p",[a._v("方式2：使用快捷键ctrl + P + Q")])]),a._v(" "),s("p",[a._v("方式1 "),s("code",[a._v("退出后，容器会停止；")])]),a._v(" "),s("p",[a._v("方式2 "),s("code",[a._v("退出后容器依然正在运行。")])]),a._v(" "),s("h3",{attrs:{id:"启动守护式容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动守护式容器"}},[a._v("#")]),a._v(" 启动守护式容器")]),a._v(" "),s("p",[a._v("大部分情况下，我们系统docker容器服务时在后台运行的，可以通过-d指定容器的后台运行模式：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" 容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("注意事项：")]),a._v(" "),s("p",[a._v("如果使用docker run -d ubuntu尝试启动守护式的ubuntu，会发现容器启动后就自动退出了。")]),a._v(" "),s("p",[a._v("因为Docker容器如果在后台运行，就必须要有一个前台进程。容器运行的命令如果不是那些一直挂起的命令（例如top、tail），就会自动退出。")]),a._v(" "),s("h2",{attrs:{id:"列出正在运行的容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#列出正在运行的容器"}},[a._v("#")]),a._v(" 列出正在运行的容器")]),a._v(" "),s("p",[a._v("列出所有正在运行的容器：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("OPTIONS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("常用参数：")]),a._v(" "),s("ul",[s("li",[a._v("-a：列出当前所有正在运行的容器+历史上运行过的容器")]),a._v(" "),s("li",[a._v("-l：显示最近创建的容器")]),a._v(" "),s("li",[a._v("-n：显示最近n个创建的容器")]),a._v(" "),s("li",[a._v("-q：静默模式，只显示容器编号")])]),a._v(" "),s("h2",{attrs:{id:"容器其他启停操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#容器其他启停操作"}},[a._v("#")]),a._v(" 容器其他启停操作")]),a._v(" "),s("h3",{attrs:{id:"启动已经停止的容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动已经停止的容器"}},[a._v("#")]),a._v(" 启动已经停止的容器")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" start 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"重启容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重启容器"}},[a._v("#")]),a._v(" 重启容器")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" restart 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"停止容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#停止容器"}},[a._v("#")]),a._v(" 停止容器")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" stop 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"强制停止容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#强制停止容器"}},[a._v("#")]),a._v(" 强制停止容器")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("kill")]),a._v(" 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"删除容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除容器"}},[a._v("#")]),a._v(" 删除容器")]),a._v(" "),s("p",[a._v("删除已经停止的容器：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("强制删除正在运行的容器：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("一次删除多个容器实例：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${docker ps -a -q}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 或者")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ps")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-q")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("xargs")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h2",{attrs:{id:"查看容器日志"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看容器日志"}},[a._v("#")]),a._v(" 查看容器日志")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" logs 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"查看容器内运行的进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看容器内运行的进程"}},[a._v("#")]),a._v(" 查看容器内运行的进程")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("top")]),a._v(" 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"查看容器内部细节"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看容器内部细节"}},[a._v("#")]),a._v(" 查看容器内部细节")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" inspect 容器ID或容器名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"进入正在运行的容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#进入正在运行的容器"}},[a._v("#")]),a._v(" 进入正在运行的容器")]),a._v(" "),s("blockquote",[s("p",[a._v("进入正在运行的容器，并以命令行交互：")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" 容器ID bashShell\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("blockquote",[s("p",[a._v("重新进入：")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" attach 容器ID\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("docker exec 和 docker attach 区别：")]),a._v(" "),s("p",[a._v("● attach直接进入容器启动命令的终端，不会启动新的进程，用exit退出会导致容器的停止\n● exec是在容器中打开新的终端，并且可以启动新的进程，用exit退出不会导致容器的停止")]),a._v(" "),s("p",[a._v("如果有多个终端，都对同一个容器执行了 docker attach，就会出现类似投屏显示的效果。一个终端中输入输出的内容，在其他终端上也会同步的显示。")]),a._v(" "),s("h2",{attrs:{id:"容器和宿主机文件拷贝"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#容器和宿主机文件拷贝"}},[a._v("#")]),a._v(" 容器和宿主机文件拷贝")]),a._v(" "),s("p",[a._v("容器内文件拷贝到宿主机：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" 容器ID:容器内路径 目的主机路径\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("宿主机文件拷贝到容器中：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" 主机路径 容器ID:容器内路径\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h2",{attrs:{id:"导入和导出容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#导入和导出容器"}},[a._v("#")]),a._v(" 导入和导出容器")]),a._v(" "),s("p",[a._v("export：导出容器的内容流作为一个tar归档文件（对应import命令）；")]),a._v(" "),s("p",[a._v("import：从tar包中的内容创建一个新的文件系统再导入为镜像（对应export命令）；")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 导出")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# docker export 容器ID > tar文件名")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" abc "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" aaa.tar\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 导入")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cat tar文件 | docker import - 自定义镜像用户/自定义镜像名:自定义镜像版本号")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" aaa.tar "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("import")]),a._v(" - test/mytest:1.0.1\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h2",{attrs:{id:"将容器生成新镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将容器生成新镜像"}},[a._v("#")]),a._v(" 将容器生成新镜像")]),a._v(" "),s("blockquote",[s("p",[a._v("将容器更新包管理以及安装vim")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#更新包管理工具")]),a._v("\napi-get update\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#安装我们需要的vim")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("docker commit提交容器副本使之成为一个新的镜像。")]),a._v(" "),s("blockquote",[s("p",[a._v("docker 启动一个镜像容器后， 可以在里面执行一些命令操作，然后使用docker commit将新的这个容器快照生成一个镜像。")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" commit "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"提交的描述信息"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-a")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"作者"')]),a._v(" 容器ID 要创建的目标镜像名:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("tag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("Docker挂载主机目录，可能会出现报错：cannot open directory .: Perission denied。")]),a._v(" "),s("p",[a._v("解决方案：在命令中加入参数 --privileged=true。")]),a._v(" "),s("p",[a._v("CentOS7安全模块比之前系统版本加强，不安全的会先禁止，目录挂载的情况被默认为不安全的行为，在SELinux里面挂载目录被禁止掉了。如果要开启，一般使用 --privileged=true，扩大容器的权限解决挂载没有权限的问题。也即使用该参数，容器内的root才拥有真正的root权限，否则容器内的root只是外部的一个普通用户权限。")]),a._v(" "),s("h2",{attrs:{id:"容器数据卷"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#容器数据卷"}},[a._v("#")]),a._v(" 容器数据卷")]),a._v(" "),s("p",[a._v("卷就是目录或文件，存在于一个或多个容器中，由docker挂载到容器，但不属于联合文件系统，因此能够绕过UnionFS，提供一些用于持续存储或共享数据。")]),a._v(" "),s("p",[a._v("特性：卷设计的目的就是数据的持久化，完全独立于容器的生存周期，因此Docker不会在容器删除时删除其挂载的数据卷。")]),a._v(" "),s("p",[a._v("特点：")]),a._v(" "),s("ul",[s("li",[a._v("数据卷可以在容器之间共享或重用数据")]),a._v(" "),s("li",[a._v("卷中的更改可以直接实施生效")]),a._v(" "),s("li",[a._v("数据卷中的更改不会包含在镜像的更新中")]),a._v(" "),s("li",[a._v("数据卷的生命周期一直持续到没有容器使用它为止")])]),a._v(" "),s("p",[a._v("运行一个带有容器卷存储功能的容器实例：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--privileged")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" 宿主机绝对路径目录:容器内目录"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("rw "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" ro"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" 镜像名\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("blockquote",[s("p",[a._v("可以使用docker inspect查看容器绑定的数据卷。")])]),a._v(" "),s("p",[a._v("容器卷的继承：")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动一个容器")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--privileged")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true /tmp/test:/tmp/docker "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" u1 ubuntu /bin/bash\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用 --volumes-from 继承 u1的容器卷映射配置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--privileged")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true --volumes-from u1 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" u2 ubuntu\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("img",{attrs:{src:t(432)}})])}),[],!1,null,null,null);s.default=r.exports}}]);
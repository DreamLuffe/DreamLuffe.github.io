(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{623:function(s,e,a){"use strict";a.r(e);var t=a(2),r=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"dockerfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),e("p",[s._v("Dockerfile是用来构建Docker镜像的文本文件，是由一条条构建镜像所需的指令和参数构成的脚本。")]),s._v(" "),e("ol",[e("li",[s._v("编写Dockerfile文件")]),s._v(" "),e("li",[s._v("docker build命令构建镜像")]),s._v(" "),e("li",[s._v("docker run依据镜像运行容器实例")])]),s._v(" "),e("h2",{attrs:{id:"构建过程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#构建过程"}},[s._v("#")]),s._v(" 构建过程")]),s._v(" "),e("p",[s._v("Dockerfile编写：")]),s._v(" "),e("ul",[e("li",[s._v("每条保留字指令都必须为大写字母，且后面要跟随至少一个参数")]),s._v(" "),e("li",[s._v("指令按照从上到下顺序执行")]),s._v(" "),e("li",[s._v("#表示注释")]),s._v(" "),e("li",[s._v("每条指令都会创建一个新的镜像层并对镜像进行提交")])]),s._v(" "),e("p",[s._v("Docker引擎执行Docker的大致流程：")]),s._v(" "),e("ol",[e("li",[s._v("docker从基础镜像运行一个容器")]),s._v(" "),e("li",[s._v("执行一条指令并对容器做出修改")]),s._v(" "),e("li",[s._v("执行类似docker commit的操作提交一个新的镜像层")]),s._v(" "),e("li",[s._v("docker再基于刚提交的镜像运行一个新容器")]),s._v(" "),e("li",[s._v("执行Dockerfile中的下一条指令，直到所有指令都执行完成")])]),s._v(" "),e("h2",{attrs:{id:"dockerfile保留字"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile保留字"}},[s._v("#")]),s._v(" Dockerfile保留字")]),s._v(" "),e("h3",{attrs:{id:"from"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#from"}},[s._v("#")]),s._v(" FROM")]),s._v(" "),e("p",[s._v("基础镜像，当前新镜像是基于哪个镜像的，指定一个已经存在的镜像作为模板。Dockerfile第一条必须是FROM")]),s._v(" "),e("div",{staticClass:"language-Dockerfile line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FROM 镜像名")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token instruction"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" hub.c.163.com/library/tomcat")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"maintainer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#maintainer"}},[s._v("#")]),s._v(" MAINTAINER")]),s._v(" "),e("p",[s._v("镜像维护者的姓名和邮箱地址")]),s._v(" "),e("div",{staticClass:"language-Dockerfile line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 非必须")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token instruction"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" ZhangSan zs@163.com")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"run"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[s._v("#")]),s._v(" RUN")]),s._v(" "),e("p",[s._v("容器构建时需要运行的命令。")]),s._v(" "),e("p",[s._v("有两种格式：")]),s._v(" "),e("p",[s._v("shell格式")]),s._v(" "),e("div",{staticClass:"language-Dockerfile line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 等同于在终端操作的shell命令")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 格式：RUN <命令行命令>")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token instruction"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum -y install vim")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("exec格式")]),s._v(" "),e("div",{staticClass:"language-Dockerfile line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 格式：RUN ["可执行文件" , "参数1", "参数2"]')]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token instruction"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" ["),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./test.php"')]),s._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),s._v(", "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"offline"')]),s._v("]  # 等价于 RUN ./test.php dev offline")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])}),[],!1,null,null,null);e.default=r.exports}}]);